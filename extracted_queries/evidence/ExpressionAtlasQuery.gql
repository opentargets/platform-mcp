# Query Name: ExpressionAtlasQuery
# Entity Type: evidence
# Description:
# Fetches Expression Atlas evidence for a target-disease association,
#  including differential expression data from RNA experiments with fold
#  changes, p-values, confidence levels, and experimental context
# Variables:
# ensemblId: String! (Example: ENSG00000232810), efoId: String! (Example:
#  EFO_0000685), size: Int! (Example: 10)
# Pagination Behavior: Paginated (returns X/page, total varies)
# Notes:
# Query executes successfully. Tested with TNF (ENSG00000232810) + rheumatoid
#  arthritis (EFO_0000685), returned count=1 with expression data
#  (log2FoldChange=2.1, pValue=0.0403, percentileRank=98, confidence=medium)
#  from study E-MTAB-3201 comparing psoriatic arthritis vs healthy in synovial
#  fluid. Also tested with BRAF (ENSG00000157764) + melanoma (EFO_0000756)
#  returning count=0, indicating sparse data coverage. Uses standard
#  pagination with size parameter. Returns disease mapping (psoriatic
#  arthritis EFO_0003778 related to rheumatoid arthritis), contrast
#  description, study overview, and Expression Atlas experiment ID. Uses
#  enableIndirect=true to find related disease evidence.
#
# Last Updated: 2025-11-21
query ExpressionAtlasQuery($ensemblId: String!, $efoId: String!, $size: Int!) {
  # Return a Disease
  disease(efoId: $efoId) {
    # Open Targets disease id
    id
    # The complete list of all possible datasources
    expressionAtlasSummary: evidences(
      ensemblIds: [$ensemblId]
      enableIndirect: true
      datasourceIds: ["expression_atlas"]
      size: $size
    ) {
      count
      rows {
        # Disease evidence
        disease {
          # Open Targets disease id
          id
          # Disease name
          name
        }
        diseaseFromSource
        contrast
        confidence
        studyOverview
        log2FoldChangeValue
        resourceScore
        log2FoldChangePercentileRank
        studyId
      }
    }
  }
}
