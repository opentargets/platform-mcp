# Query Name: EuropePMCQuery
# Entity Type: evidence
# Description:
# Retrieves Europe PMC text mining evidence for a target-disease association,
#  including literature references and text mining sentences with exact term
#  positions in publications
# Variables:
# ensemblId: String! (Example: ENSG00000157764), efoId: String! (Example:
#  EFO_0000756), size: Int! (Example: 5), cursor: String (optional for
#  pagination)
# Pagination Behavior: Cursor-based pagination (returns cursor field for next page)
# Notes:
# Query successfully tested with BRAF (ENSG00000157764) + melanoma
#  (EFO_0000756), size=5. Returns count=13874 evidence entries with complete
#  data including disease/target info, literature array with PMIDs,
#  textMiningSentences with exact positions (tStart/tEnd for target,
#  dStart/dEnd for disease, section, full text), and resourceScore.
#  Cursor-based pagination confirmed working (first cursor:
#  WzEsIjE1MzU3NDIxMGZiODdmNDc1YjU4NmU4ZjIxZTdhNmJkNWUxNzU2ZGQiXQ==, second
#  cursor: WzEsIjIyNDI5YTM3Y2VhYmVlOTE5MzEyNjBhMWYyNTYyN2JkZmFiZDk0NWYiXQ==).
#  Uses enableIndirect=true to include indirect associations. Text mining
#  sentences show co-occurrence of target and disease terms in literature
#  sections (abstract, intro, results, discuss, etc). Body.jsx merges results
#  with EuropePMC API for additional metadata (title, authors, journal, year,
#  abstract).
#
# Last Updated: 2025-11-21
query EuropePMCQuery(
  $ensemblId: String!
  $efoId: String!
  $size: Int!
  $cursor: String
) {
  # Return a Disease
  disease(efoId: $efoId) {
    # Open Targets disease id
    id
    # The complete list of all possible datasources
    europePmc: evidences(
      ensemblIds: [$ensemblId]
      enableIndirect: true
      size: $size
      datasourceIds: ["europepmc"]
      cursor: $cursor
    ) {
      count
      cursor
      rows {
        # Disease evidence
        disease {
          # Disease name
          name
          # Open Targets disease id
          id
        }
        # Target evidence
        target {
          # HGNC approved symbol
          approvedSymbol
          # Open Targets target id
          id
        }
        # list of pub med publications ids
        literature
        textMiningSentences {
          tStart
          tEnd
          dStart
          dEnd
          section
          text
        }
        resourceScore
      }
    }
  }
}
