# Query Name: OTCrisprQuery
# Entity Type: evidence
# Description:
# Fetches Open Targets CRISPR evidence data for a target-disease pair,
#  including cell line information, fold changes, and significance scores from
#  CRISPR screens
# Variables:
# ensemblId: String! (Example: ENSG00000157764), efoId: String! (Example:
#  EFO_0000756), size: Int! (Example: 10)
# Pagination Behavior: Paginated (returns X/page based on size parameter, total varies)
# Notes:
# Query executes successfully with valid syntax and returns proper response
#  structure with count and rows fields. Tested with BRAF (ENSG00000157764) +
#  melanoma (EFO_0000756), returned count=0 indicating sparse data coverage -
#  OT CRISPR is private/partner data with limited availability. Uses standard
#  offset-based pagination with size parameter (default from
#  sectionsBaseSizeQuery constant). Returns comprehensive CRISPR screening
#  data including disease mapping (id, name), projectId (OTAR project codes
#  linking to home.opentargets.org), contrast (experimental conditions),
#  studyOverview (study descriptions), cellType, cellLineBackground (cell line
#  genetic context), crisprScreenLibrary (library used), statisticalTestTail,
#  resourceScore (significance measure), log2FoldChangeValue (effect size),
#  diseaseCellLines array with names (cancer cell lines tested), and
#  releaseVersion. enableIndirect=true to include related disease evidence.
#  datasourceIds=['ot_crispr'] targets Open Targets CRISPR data. Related to
#  OTCrisprSummary.gql fragment which fetches only count for summary display.
#  Evidence from CRISPR knockout screens identifying essential genes in
#  disease-relevant cell lines.
#
# Last Updated: 2025-11-21
query OTCrisprQuery($ensemblId: String!, $efoId: String!, $size: Int!) {
  # Return a Disease
  disease(efoId: $efoId) {
    # Open Targets disease id
    id
    # The complete list of all possible datasources
    OtCrisprSummary: evidences(
      ensemblIds: [$ensemblId]
      enableIndirect: true
      datasourceIds: ["ot_crispr"]
      size: $size
    ) {
      count
      rows {
        # Disease evidence
        disease {
          # Open Targets disease id
          id
          # Disease name
          name
        }
        projectId
        contrast
        studyOverview
        cellType
        cellLineBackground
        crisprScreenLibrary
        statisticalTestTail
        resourceScore
        log2FoldChangeValue
        diseaseCellLines {
          name
        }
        # Release version
        releaseVersion
      }
    }
  }
}
