# Query Name: ValidationQuery
# Entity Type: evidence
# Description:
# Fetches Open Targets CRISPR validation lab evidence for a target-disease
#  pair, including cell line data, biomarkers, assay results, and project
#  assessments. Returns detailed experimental validation data from the OT
#  Validation Lab.
# Variables:
# ensemblId: String! (Example: ENSG00000157764), efoId: String! (Example:
#  EFO_0000756), size: Int! (Example: 3500)
# Pagination Behavior: Paginated (returns X/page based on size parameter, total varies)
# Notes:
# Query executes successfully with valid syntax and returns proper response
#  structure with count and rows fields. Tested with BRAF (ENSG00000157764) +
#  melanoma (EFO_0000756) and TP53 (ENSG00000141510) + rheumatoid arthritis
#  (EFO_0000685), both returned count=0 indicating sparse data coverage - OT
#  CRISPR Validation is a private/partner datasource from Open Targets Partner
#  Programme with restricted availability. Uses standard offset-based
#  pagination with size parameter (default sectionsBaseSizeQuery=3500).
#  Returns comprehensive validation lab data including disease info (id,
#  name), projectId (OTAR project identifier), studyOverview (study
#  description), diseaseCellLines array (id/name/tissue/tissueId for cancer
#  cell lines tested), resourceScore (effect size metric), biomarkerList array
#  (name/description of cell line biomarkers like BRAF_mut, KRAS_mut),
#  releaseVersion, primaryProjectId (links to home.opentargets.org OTAR
#  projects), primaryProjectHit (boolean indicating if gene was hit in primary
#  screen), assessments array (OTVL assessment conclusions), and assays array
#  (description/isHit/shortName for CellTiterGlo/CellTox/Cell Confluence
#  viability/toxicity assays). enableIndirect=true includes related disease
#  evidence. datasourceIds=['ot_crispr_validation'] targets OT Validation Lab
#  data. Related to OTValidationSummary.gql fragment which fetches only count
#  for summary display. Evidence from CRISPR knockout screens validating
#  therapeutic target hypotheses in disease-relevant cell lines. Query
#  structure identical to ValidationQuery name in source file.
#
# Last Updated: 2025-11-21
query ValidationQuery($ensemblId: String!, $efoId: String!, $size: Int!) {
  # Return a Disease
  disease(efoId: $efoId) {
    # Open Targets disease id
    id
    # The complete list of all possible datasources
    otValidationSummary: evidences(
      ensemblIds: [$ensemblId]
      enableIndirect: true
      datasourceIds: ["ot_crispr_validation"]
      size: $size
    ) {
      count
      rows {
        # Disease evidence
        disease {
          # Open Targets disease id
          id
          # Disease name
          name
        }
        projectId
        studyOverview
        diseaseCellLines {
          id
          name
          tissue
          tissueId
        }
        resourceScore
        biomarkerList {
          name
          description
        }
        # Release version
        releaseVersion
        # Primary Project Id
        primaryProjectId
        # Primary Project Hit
        primaryProjectHit
        # Assessments
        assessments
        assays {
          description
          isHit
          shortName
        }
      }
    }
  }
}
