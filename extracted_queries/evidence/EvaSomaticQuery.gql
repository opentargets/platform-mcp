# Query Name: EvaSomaticQuery
# Entity Type: evidence
# Description:
# Retrieves somatic mutation evidence from EVA (European Variation Archive)
#  and ClinVar for a specific target-disease association, including variant
#  details, clinical significance, and cancer hallmarks for the target gene
# Variables: ensemblId: String!, efoId: String!, size: Int!, cursor: String
# Pagination Behavior: Paginated (returns 25/page, total varies)
# Notes:
# Query executes successfully. Uses cursor-based pagination. Tested with BRAF
#  (ENSG00000157764) and melanoma (EFO_0000756), returned count=1 with 1
#  somatic variant (rs121913377). Also returns target hallmarks data including
#  cancer role information.
#
# Last Updated: 2025-11-21
query EvaSomaticQuery($ensemblId: String!, $efoId: String!, $size: Int!, $cursor: String) {
  # Return a Disease
  disease(efoId: $efoId) {
    # Open Targets disease id
    id
    # The complete list of all possible datasources
    eva_somatic: evidences(
      ensemblIds: [$ensemblId]
      enableIndirect: true
      datasourceIds: ["eva_somatic"]
      size: $size
      cursor: $cursor
    ) {
      cursor
      count
      rows {
        # Disease evidence
        disease {
          # Open Targets disease id
          id
          # Disease name
          name
        }
        variant {
          hgvsId
        }
        # Variant effect
        variantEffect
        # Direction On Trait
        directionOnTrait
        diseaseFromSource
        variant {
          id
          hgvsId
          referenceAllele
          alternateAllele
        }
        # Variant dbSNP identifier
        variantRsId
        studyId
        clinicalSignificances
        allelicRequirements
        alleleOrigins
        confidence
        # list of pub med publications ids
        literature
        cohortPhenotypes
      }
    }
  }
  # Return a Target
  target(ensemblId: $ensemblId) {
    # Open Targets target id
    id
    # Target-modulated essential alterations in cell physiology that dictate malignant growth
    hallmarks {
      attributes {
        description
        pmid
        name
      }
    }
  }
}
